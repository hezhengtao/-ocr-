# 智能OCR处理器

## 项目简介
智能OCR处理器是一款基于Python开发的桌面应用程序，集成了多种OCR识别引擎，支持多颜色笔迹检测、智能排序、文档导出等功能。软件具备现代化UI界面，支持深浅色主题切换，适用于教育、办公等多种场景。

## 功能特性

### 1. 核心OCR功能
- 支持多引擎选择：PaddleOCR-VL、PP-OCRv5、PP-StructureV3
- 支持图片和PDF文件识别
- 自动重试机制，增强网络稳定性
- 智能文本块提取与排序

### 2. 多颜色笔迹检测
- 支持检测红色、蓝色、绿色、紫色、黄色笔迹
- 新增"任意颜色"检测模式
- 自动识别图像中的主要批注颜色
- 高亮显示检测结果并保存图像

### 3. 智能文本处理
- 题号自动识别与排序（支持多种格式：1.、1、、(1)、一、、①②③）
- 选项结构智能识别（A. B. C. D.）
- 文本清洗功能，支持自定义黑名单关键词
- 全局智能排序，解决多文件乱序问题

### 4. 输出格式
- 支持多种输出格式：Word(.docx)、Markdown(.md)、纯文本(.txt)、JSON(.json)
- 可选择合并所有结果为单个文件
- 支持讲义格式排版
- 自动添加文件来源标记

### 5. 用户界面
- 现代化UI设计，支持深浅色主题
- 高DPI屏幕自适应
- 文件预览功能，支持单个文件删除
- 实时日志显示，支持日志清空
- 完善的Tooltip提示系统

## 系统要求

### 软件依赖
- Python 3.7+
- OpenCV (可选，用于笔迹检测功能)
- Pillow
- requests
- python-docx
- numpy (可选，配合OpenCV使用)

### 硬件要求
- Windows 7及以上系统
- 4GB以上内存
- 支持高DPI显示的显示器（推荐）

## 安装与配置

### 1. 安装Python依赖
```bash
pip install -r requirements.txt
2. API Token配置
首次运行程序会在程序目录生成config.ini文件

在配置界面点击"修改/配置"按钮

输入从百度AI Studio获取的API Token

或直接编辑config.ini文件中的[API]节

3. 可选依赖安装
如需使用笔迹检测功能，请安装OpenCV：

bash
pip install opencv-python opencv-python-headless
使用说明
1. 基本操作流程
启动程序，选择界面主题（浅色/深色）

在左侧面板添加文件或文件夹

在"配置"选项卡设置API Token

在"识别"选项卡配置识别参数

在"输出"选项卡设置保存路径和格式

点击"开始处理"按钮或按F5键开始处理

2. 主要功能说明
文件管理
添加文件：支持图片(.png, .jpg, .jpeg, .bmp)和PDF

添加文件夹：批量添加文件夹内的所有图片和PDF

文件预览：显示缩略图和文件名

单个删除：点击文件卡片上的"× 删除"按钮

识别设置
引擎选择：根据不同文档类型选择合适的OCR引擎

题号识别：自动识别和排序题目编号

批注检测：启用多颜色笔迹检测功能

文本清洗：过滤不需要的关键词行

输出控制
保存目录：设置结果文件保存位置

文件名前缀：为输出文件添加自定义前缀

文件格式：选择输出文档格式

合并输出：将所有文件合并为单个文档

3. 快捷键
F5：开始处理

Delete：清空文件列表

Ctrl+O：添加文件

Ctrl+Shift+O：添加文件夹

技术特点
1. 多线程处理
使用独立线程进行OCR处理，避免界面卡顿

支持处理过程中的任务停止

实时进度显示

2. 智能算法
自适应文本块排序算法

笔迹颜色自动分析

智能纠错机制# -ocr-
智能化的icr工具
